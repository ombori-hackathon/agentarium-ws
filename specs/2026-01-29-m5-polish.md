# M5: Polish

## Summary
Competition-ready polish. HUD overlay, camera controls, visual effects. Frontend-only milestone to make the demo impressive.

## Dependencies
- Requires: M4 (working end-to-end flow)
- Blocks: None (final milestone)

## HUD Layout

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    AGENTARIUM     â”‚
â”‚ â”‚ â–   claude-1          â”‚                    â— Connected    â”‚
â”‚ â”‚ ğŸ“ /src/index.ts     â”‚                                   â”‚
â”‚ â”‚ ğŸ’­ "Reading imports" â”‚                                   â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                   â”‚
â”‚                                                            â”‚
â”‚                      [ 3D SCENE ]                          â”‚
â”‚                                                            â”‚
â”‚                                               [zoom +/-]   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Frontend Tasks

| ID | Task | File | Status |
|----|------|------|--------|
| M5.S1 | Create HUD overlay (SwiftUI over SceneKit) | `Sources/Views/HUDOverlay.swift` | ğŸ”² |
| M5.S2 | Add title "AGENTARIUM" in top-right | `Sources/Views/HUDOverlay.swift` | ğŸ”² |
| M5.S3 | Add connection status indicator | `Sources/Views/HUDOverlay.swift` | ğŸ”² |
| M5.S4 | Create AgentCard component | `Sources/Views/AgentCard.swift` | ğŸ”² |
| M5.S5 | Show agent name in card | `Sources/Views/AgentCard.swift` | ğŸ”² |
| M5.S6 | Show current file path in card | `Sources/Views/AgentCard.swift` | ğŸ”² |
| M5.S7 | Show thought in card | `Sources/Views/AgentCard.swift` | ğŸ”² |
| M5.S8 | Implement slow orbiting camera | `Sources/Scene/CameraController.swift` | ğŸ”² |
| M5.S9 | Pause orbit on user interaction | `Sources/Scene/CameraController.swift` | ğŸ”² |
| M5.S10 | Resume orbit after 5s of no interaction | `Sources/Scene/CameraController.swift` | ğŸ”² |
| M5.S11 | Add manual camera drag (rotate view) | `Sources/Scene/CameraController.swift` | ğŸ”² |
| M5.S12 | Add zoom controls (+/- buttons) | `Sources/Views/HUDOverlay.swift` | ğŸ”² |
| M5.S13 | Add scroll wheel zoom | `Sources/Scene/CameraController.swift` | ğŸ”² |
| M5.S14 | Add bloom/glow post-processing | `Sources/Scene/TerrainScene.swift` | ğŸ”² |
| M5.S15 | Add floating particles effect | `Sources/Scene/Nodes/ParticleNode.swift` | ğŸ”² |
| M5.S16 | Add grid line pulse animation | `Sources/Scene/Nodes/GridNode.swift` | ğŸ”² |

## Visual Specs

### HUD Overlay
- **Framework:** SwiftUI overlay on SceneView
- **Font:** SF Mono throughout
- **Colors:** Match scene palette

### Title
- **Text:** "AGENTARIUM"
- **Font:** SF Mono Bold, 24pt
- **Color:** `#00ffff` (cyan)
- **Position:** Top-right, 20pt padding

### Connection Status
- **Connected:** Green circle + "Connected"
- **Disconnected:** Red circle + "Disconnected"
- **Color connected:** `#00ff88`
- **Color disconnected:** `#ff4444`
- **Position:** Below title

### AgentCard
- **Background:** Black at 70% opacity, rounded corners 8pt
- **Border:** `#00ff88` 1pt
- **Position:** Top-left, 20pt padding
- **Width:** 220pt
- **Content:**
  - Agent indicator (colored square)
  - Name: "claude-1" (truncated session ID)
  - File path: "ğŸ“ /src/index.ts"
  - Thought: "ğŸ’­ Reading imports..."

### Camera Orbit
- **Radius:** 50 units from scene center
- **Height:** 30 units above ground
- **Speed:** 360Â° per 60 seconds (slow rotation)
- **Look at:** Scene center (0, 5, 0)

### Camera Controls
- **Drag:** Rotate camera around center
- **Scroll:** Zoom in/out
- **Zoom range:** 20 - 150 units from center
- **Interaction timeout:** 5 seconds to resume orbit

### Bloom Effect
- **Threshold:** 0.8
- **Intensity:** 0.5
- **Blur radius:** 4

### Floating Particles
- **Count:** 100 particles
- **Color:** `#00ffff` at 30% opacity
- **Size:** 0.1 units
- **Movement:** Slow random drift upward
- **Spawn area:** Entire terrain bounds
- **Lifetime:** 10 seconds, respawn

### Grid Pulse
- **Animation:** Opacity waves from center
- **Speed:** One pulse every 5 seconds
- **Opacity range:** 20% â†’ 60% â†’ 20%
- **Wave radius:** Expand from center outward

## Tests

### Frontend
```bash
cd apps/macos-client && swift test
```

### Manual Testing
1. Verify HUD displays correctly over 3D scene
2. Verify connection status updates on connect/disconnect
3. Verify AgentCard shows correct info when agent spawns
4. Verify camera orbits slowly when idle
5. Drag to rotate - verify orbit pauses
6. Wait 5s - verify orbit resumes
7. Use scroll wheel - verify zoom works
8. Verify bloom makes terrain glow
9. Verify particles float upward
10. Verify grid has subtle pulse animation

## Acceptance Criteria
- [ ] HUD overlay renders without blocking 3D interaction
- [ ] Title "AGENTARIUM" visible in cyan
- [ ] Connection status shows correct state
- [ ] AgentCard appears when agent spawns
- [ ] AgentCard shows agent name
- [ ] AgentCard shows current file path
- [ ] AgentCard shows latest thought
- [ ] Camera orbits slowly by default
- [ ] Drag rotates camera and pauses orbit
- [ ] Orbit resumes after 5s of no interaction
- [ ] Scroll wheel zooms in/out
- [ ] Zoom buttons work
- [ ] Bloom effect visible on bright elements
- [ ] Particles drift slowly upward
- [ ] Grid has animated pulse effect

## Demo Checklist

Before presenting:
- [ ] Backend running on localhost:8000
- [ ] Swift app running fullscreen
- [ ] Hooks configured in `~/.claude/settings.json`
- [ ] Test codebase selected (phystack-web)
- [ ] Claude Code ready in terminal
- [ ] Network stable for WebSocket

Demo flow:
1. Show empty terrain (no agent)
2. Start Claude Code session
3. Agent appears - camera follows
4. Ask Claude to explore the codebase
5. Watch agent move between files
6. Show thought bubbles updating
7. End session - agent disappears
8. Show camera orbit and controls

## PRs
- Frontend: [link when created]
